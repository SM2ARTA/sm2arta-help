<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Loadingâ€¦</title>
  <script>
  (async () => {
    const START = 'SM2ARTA%20Admin%20Guide.html';
    const here = new URL(location.href);
    const current = here.searchParams.get('v') || '';  // keep current if any

    // Try to get latest version; if it fails, keep the current one (avoids loop)
    let latest = current;
    try {
      const res = await fetch('version.json?ts=' + Date.now(), { cache: 'no-store' });
      if (res.ok) {
        const data = await res.json();
        if (data && data.v) latest = String(data.v);
      }
    } catch (e) { /* ignore; latest stays as current */ }

    // Optional: service worker to prefer network (keeps refreshes fresh after first visit)
    if ('serviceWorker' in navigator) {
      try { await navigator.serviceWorker.register('sw.js?v=' + encodeURIComponent(latest)); } catch (e) {}
    }

    // If we discovered a different version, rewrite once; otherwise go to start page
    if (latest && latest !== current) {
      here.searchParams.set('v', latest);
      location.replace(here.toString());
      return;
    }

    // Navigate to your start page, preserving query/hash
    location.replace(START + location.search + location.hash);
  })();
  </script>

  <noscript>
    <meta http-equiv="refresh" content="0; url=SM2ARTA%20Admin%20Guide.html">
  </noscript>
</head>
<body></body>
</html>
